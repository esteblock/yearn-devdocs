"use strict";(self.webpackChunkyearn_devdocs=self.webpackChunkyearn_devdocs||[]).push([[2810],{30749:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>d,metadata:()=>c,toc:()=>o});var i=t(74848),a=t(28453);const d={},s="Auctions",c={id:"auctions",title:"Auctions",description:"Introduction",source:"@site/docs/developers/auctions.md",sourceDirName:".",slug:"/auctions",permalink:"/developers/auctions",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedAt:1724183848e3,frontMatter:{},sidebar:"developers",previous:{title:"ySwaps",permalink:"/developers/v2/yswaps"},next:{title:"Ledger Plugin",permalink:"/developers/v2/ledger-plugin"}},l={},o=[{value:"Introduction",id:"introduction",level:2},{value:"How it works",id:"how-it-works",level:3},{value:"Addresses",id:"addresses",level:3},{value:"Specification",id:"specification",level:2},{value:"Events",id:"events",level:3},{value:"AuctionEnabled",id:"auctionenabled",level:4},{value:"AuctionDisabled",id:"auctiondisabled",level:4},{value:"AuctionKicked",id:"auctionkicked",level:4},{value:"AuctionTaken",id:"auctiontaken",level:4},{value:"View methods",id:"view-methods",level:3},{value:"auctionLength",id:"auctionlength",level:4},{value:"auctionCooldown",id:"auctioncooldown",level:4},{value:"auctionInfo",id:"auctioninfo",level:4},{value:"getAmountNeeded",id:"getamountneeded",level:4},{value:"price",id:"price",level:4},{value:"kickable",id:"kickable",level:4},{value:"Write methods",id:"write-methods",level:3},{value:"kick",id:"kick",level:4},{value:"take",id:"take",level:4}];function r(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"auctions",children:"Auctions"}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsx)(n.p,{children:"Yearn regularly holds permissionless Dutch auctions, most notably for V3 strategies and YFI buybacks. This process has been standardized to encourage integration by searchers."}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works",children:"How it works"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Each ",(0,i.jsx)(n.code,{children:"want"})," token has a dedicated auction contract. Many different ",(0,i.jsx)(n.code,{children:"sell"}),' tokens can be offered through distinct auctions through this contract, receiving the same asset in return. In other words, "Sell DAI for YFI" and "Sell WETH for YFI" can both supported through the same contract with WETH as the asset, but any one auction will only sell either DAI or WETH, never both.']}),"\n",(0,i.jsx)(n.li,{children:"Tokens for sale accumulate either in their respective auction contracts directly, or in the contracts that rely on the auctions (and get transferred to the auction contract at the start of the auction)."}),"\n",(0,i.jsxs)(n.li,{children:["An auction can be initiated either once a sufficient ",(0,i.jsx)(n.code,{children:"sell"})," amount accumulates, or upon a manual ",(0,i.jsx)(n.code,{children:"kick()"})," call that is permissionless.\nAuctions can last up to 24 hours and occur no more than once within some configurable interval, like weekly."]}),"\n",(0,i.jsx)(n.li,{children:"The initial price is set high and decreases with time, halving every hour."}),"\n",(0,i.jsxs)(n.li,{children:["Takers can ",(0,i.jsx)(n.code,{children:"take()"})," the sell token on offer at the current price, providing asset to the contract in return."]}),"\n",(0,i.jsx)(n.li,{children:"The auction concludes once all sell in the batch is sold or 24 hours elapse."}),"\n",(0,i.jsx)(n.li,{children:"Unsold sell carries over to the subsequent auction."}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"addresses",children:"Addresses"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Name"}),(0,i.jsx)(n.th,{children:"Address"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Auction factory"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://etherscan.io/address/0xE6aB098E8582178A76DC80d55ca304d1Dec11AD8",children:(0,i.jsx)(n.code,{children:"0xE6aB098E8582178A76DC80d55ca304d1Dec11AD8"})})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"YFI buyback auctions"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.a,{href:"https://etherscan.io/address/0x4349ed200029e6Cf38F1455B9dA88981F1806df3",children:(0,i.jsx)(n.code,{children:"0x4349ed200029e6Cf38F1455B9dA88981F1806df3"})})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"specification",children:"Specification"}),"\n",(0,i.jsx)(n.h3,{id:"events",children:"Events"}),"\n",(0,i.jsx)(n.h4,{id:"auctionenabled",children:"AuctionEnabled"}),"\n",(0,i.jsx)(n.p,{children:"Emitted when an auction is enabled to tell parties to track it."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: AuctionEnabled\n   type: event\n   \n   inputs:\n    - name: auctionId\n      indexed: false\n      type: bytes32\n      \n    - name: sell\n      indexed: true\n      type: address\n      \n    - name: want\n      indexed: true\n      type: address\n      \n    - name: auctionAddress\n      indexed: true\n      type: address\n"})}),"\n",(0,i.jsx)(n.h4,{id:"auctiondisabled",children:"AuctionDisabled"}),"\n",(0,i.jsx)(n.p,{children:"Emitted when an Auction is disabled so it no longer needs to be tracked."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: AuctionDisabled\n   type: event\n   \n   inputs:\n    - name: auctionId\n      indexed: false\n      type: bytes32\n      \n    - name: sell\n      indexed: true\n      type: address\n      \n    - name: want\n      indexed: true\n      type: address\n      \n    - name: auctionAddress\n      indexed: true\n      type: address\n"})}),"\n",(0,i.jsx)(n.h4,{id:"auctionkicked",children:"AuctionKicked"}),"\n",(0,i.jsx)(n.p,{children:"Emitted when a new auction is kicked off."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: AuctionKicked\n   type: event\n   \n   inputs:\n    - name: auctionId\n      indexed: true\n      type: bytes32\n      \n    - name: sellAvailable\n      indexed: false\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"auctiontaken",children:"AuctionTaken"}),"\n",(0,i.jsx)(n.p,{children:"Emitted when some amount of sell is taken."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: AuctionTaken\n   type: event\n   \n   inputs:\n    - name: auctionId\n      indexed: true\n      type: bytes32\n      \n    - name: amountTaken\n      indexed: false\n      type: uint256\n      \n    - name: amountLeft\n      indexed: false\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h3,{id:"view-methods",children:"View methods"}),"\n",(0,i.jsx)(n.h4,{id:"auctionlength",children:"auctionLength"}),"\n",(0,i.jsx)(n.p,{children:"Get the time length of each auction."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: auctionLength\n   type: function\n   stateMutability: view\n   \n   inputs: []\n   \n   outputs:\n    - name: auctionLengthTime\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"auctioncooldown",children:"auctionCooldown"}),"\n",(0,i.jsx)(n.p,{children:"Get the minimum time inbetween auction kicks."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: auctionCooldown\n   type: function\n   stateMutability: view\n   \n   inputs: []\n   \n   outputs:\n    - name: auctionCooldownTime\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"auctioninfo",children:"auctionInfo"}),"\n",(0,i.jsx)(n.p,{children:"Get all of the info for a specific auction."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: auctionInfo\n   type: function\n   stateMutability: view\n   \n   inputs:\n     - name: auctionId\n       type: bytes32\n       \n    outputs:\n     - name: sell\n       type: address\n       \n     - name: want\n       type: address\n       \n     - name: kicked\n       type: uint256\n       \n     - name: available\n       type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"getamountneeded",children:"getAmountNeeded"}),"\n",(0,i.jsxs)(n.p,{children:["Get the exact amount of ",(0,i.jsx)(n.code,{children:"want"})," needed to buy ",(0,i.jsx)(n.code,{children:"sell"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Will return ",(0,i.jsx)(n.code,{children:"0"})," if nothing to take."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- name: getAmountNeeded\n  type: function\n  stateMutability: view\n\n  inputs: \n    - name: id\n      type: bytes32\n      \n    - name: amoutToTake\n      type: uint256\n      \n    - name: timestamp\n      type: uint256\n      default: block.timestamp\n      \n  outputs:\n    - name: currentPrice\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"price",children:"price"}),"\n",(0,i.jsxs)(n.p,{children:["Get the current price of ",(0,i.jsx)(n.code,{children:"sell"})," in terms of ",(0,i.jsx)(n.code,{children:"want"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- name: price\n  type: function\n  stateMutability: view\n\n  inputs: \n    - name: id\n      type: bytes32\n      \n    - name: timestamp\n      type: uint256\n      default: block.timestamp\n      \n  outputs:\n    - name: currentPrice\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"kickable",children:"kickable"}),"\n",(0,i.jsxs)(n.p,{children:["Get the expected amount of ",(0,i.jsx)(n.code,{children:"sell"})," that would be available if auction was kicked."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Inclusive of anything left over unsold from the last auction"}),"\n",(0,i.jsx)(n.li,{children:"May not be entirely accurate of the effect of an actual kick."}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"- name: kickable\n  type: function\n  stateMutability: view\n\n  inputs: \n    - name: id\n      type: bytes32\n      \n  outputs:\n    - name: expectedAvailable\n      type: uint256\n"})}),"\n",(0,i.jsx)(n.h3,{id:"write-methods",children:"Write methods"}),"\n",(0,i.jsx)(n.h4,{id:"kick",children:"kick"}),"\n",(0,i.jsx)(n.p,{children:"Kicks an auction."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: kick\n   type: function\n   stateMutability: nonpayable\n   \n   inputs:\n    - name: auctionId\n      type: bytes32\n      \n    outputs:\n     - name: amountAvailable\n       type: uint256\n"})}),"\n",(0,i.jsx)(n.h4,{id:"take",children:"take"}),"\n",(0,i.jsxs)(n.p,{children:["Take some amount of ",(0,i.jsx)(n.code,{children:"sell"})," for ",(0,i.jsx)(n.code,{children:"want"})," at the current price."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: take\n   type: function\n   stateMutability: nonpayable\n   \n   inputs:\n    - name: auctionId\n      type: bytes32\n      \n    - name: maxAmount\n      type: uint256\n      default: 2 ** 256 - 1\n      \n    - name: receiver\n      type: address\n      default: msg.sender\n      \n    - name: data\n      type: bytes\n      default: empty\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"NOTE:"})}),"\n",(0,i.jsxs)(n.p,{children:["If the optional 'data' parameter is supplied the auction will do a callback to the receiver address after sending the ",(0,i.jsx)(n.code,{children:"sell"})," but before pulling the ",(0,i.jsx)(n.code,{children:"want"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"The receiver will need to implement following function to receive the callback:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:" - name: auctionTakeCallback \n   type: function\n   stateMutability: nonpayable\n   \n   inputs:\n    - name: auctionId\n      type: bytes32\n      \n    - name: sender\n      type: address\n      \n    - name: amountTaken\n      type: uint256\n      \n    - name: amountNeeded\n      type: uint256\n      \n    - name: data\n      type: bytes\n      default: empty\n"})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var i=t(96540);const a={},d=i.createContext(a);function s(e){const n=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(d.Provider,{value:n},e.children)}}}]);